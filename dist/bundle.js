(()=>{"use strict";class e{constructor(e,t,n,r){this.templateEl=document.getElementById(e),this.hostEl=document.getElementById(t);const s=document.importNode(this.templateEl.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostEl.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e,t,n){const r=n.value;return{configurable:!0,enumerable:!1,get(){return r.bind(this)}}}function n(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<e.maxLength),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>e.minLength),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<e.max),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>e.min),t}var r;!function(e){e[e.Active=0]="Active",e[e.Finshed=1]="Finshed"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class l extends i{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new l),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const o=l.getInstance();class a extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputEl=this.element.querySelector("#title"),this.descriptionInputEl=this.element.querySelector("#description"),this.peopleInputEl=this.element.querySelector("#people"),this.configure()}gatherUserInput(){const e=this.titleInputEl.value,t=this.descriptionInputEl.value,r=this.peopleInputEl.value,s={value:t,required:!0,minLength:5},i={value:+r,required:!0,min:0,max:5};return n({value:e,required:!0})&&n(s)&&n(i)?[e,t,+r]:void alert("Invalid input, please try again")}clearInputs(){this.titleInputEl.value="",this.descriptionInputEl.value="",this.peopleInputEl.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;o.addProject(e,n,r),console.log(e,n,r),this.clearInputs()}}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([t],a.prototype,"submitHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends e{get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}c([t],d.prototype,"dragStartHandler",null),c([t],d.prototype,"dragEndHandler",null);var p=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class u extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"===this.type?r.Active:r.Finshed)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),o.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finshed));this.assignedProjects=t,this.renderProject()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProject(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new d(this.element.querySelector("ul").id,e)}}p([t],u.prototype,"dragOverHandler",null),p([t],u.prototype,"dropHandler",null),p([t],u.prototype,"dragLeaveHandler",null),new a,new u("active"),new u("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUQsR0FEQ0EsRyxxQ0NoQ0wsSUFBSW9ELEVBQ0osSUFBSWtDLEVBQVksVUFDaEIsSUFBSUEsRUFBWSxXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY2UtdHMvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS10cy8uL3NyYy9kZWNvcmF0ZXJzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3ByYWN0aWNlLXRzLy4vc3JjL3V0aWwvdmFsaWRhdGlvbi50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS10cy8uL3NyYy9tb2RlbHMvc3RhdHVzLnRzIiwid2VicGFjazovL3ByYWN0aWNlLXRzLy4vc3JjL3N0YXRlL3N0YXRlLnRzIiwid2VicGFjazovL3ByYWN0aWNlLXRzLy4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS10cy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS10cy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS10cy8uL3NyYy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiICAvLyBDb21wb25lbnQgYmFzZSBjbGFzc1xyXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcclxuICAgIHRlbXBsYXRlRWw6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICBob3N0RWw6IFQ7XHJcbiAgICBlbGVtZW50OiBVO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgICB0ZW1scGxhdGVJZDogc3RyaW5nLFxyXG4gICAgICAgICBob3N0RWxJZDogc3RyaW5nLFxyXG4gICAgICAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxyXG4gICAgICAgICBuZXdFbElkPzogc3RyaW5nIFxyXG4gICAgICAgICkge1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbWxwbGF0ZUlkKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgICAgICB0aGlzLmhvc3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbElkKSEgYXMgVDtcclxuXHJcbiAgICAgICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLnRlbXBsYXRlRWwuY29udGVudCwgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0ZWROb2RlLmZpcnN0RWxlbWVudENoaWxkIGFzIFU7XHJcbiAgICAgICAgaWYgKG5ld0VsSWQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxJZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYXR0YWNoKGluc2VydEF0U3RhcnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXR0YWNoKGluc2VydEF0QmVnaW5uaW5nOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5ob3N0RWwuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KGluc2VydEF0QmVnaW5uaW5nID8gJ2FmdGVyYmVnaW4nOiAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50KVxyXG4gICAgfVxyXG5cclxuICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xyXG4gICAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG59XHJcbiIsIi8vIEF1dG9iaW4gZGVjb3JhdGVyXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEF1dG9iaW5kKF86IGFueSwgXzI6IHN0cmluZyB8IFN5bWJvbCwgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XHJcbiAgICBjb25zdCBvcmlnaW5EZXNjcmlwdG9yID0gZGVzY3JpcHRvci52YWx1ZTtcclxuICAgIGNvbnN0IGFkakRlc2NyaXB0b3IgPSB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGdldCgpIHtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uQmluZCA9IG9yaWdpbkRlc2NyaXB0b3IuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbkJpbmQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFkakRlc2NyaXB0b3I7XHJcbn0iLCJcclxuICAgIC8vIHZhbGlkYXRpb24gaW50ZXJmYWNlXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGUge1xyXG4gICAgdmFsdWU6IHN0cmluZyB8IG51bWJlcixcclxuICAgIHJlcXVpcmVkPzogYm9vbGVhbixcclxuICAgIG1heExlbmd0aD86IG51bWJlcixcclxuICAgIG1pbkxlbmd0aD86IG51bWJlcixcclxuICAgIG1heD86IG51bWJlcixcclxuICAgIG1pbj86IG51bWJlclxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGFibGVJbnB1dDogVmFsaWRhdGFibGUpIHtcclxuICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTtcclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0LnJlcXVpcmVkKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggIT09IDBcclxuICAgIH1cclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aCAhPSBudWxsICYmXHJcbiAgICAgICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT0gJ3N0cmluZydcclxuICAgICkge1xyXG4gICAgICAgIGlzVmFsaWQgPVxyXG4gICAgICAgIGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPCB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcclxuICAgIH1cclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aCAhPSBudWxsICYmXHJcbiAgICAgICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT0gJ3N0cmluZydcclxuICAgICkge1xyXG4gICAgICAgIGlzVmFsaWQgPVxyXG4gICAgICAgIGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPiB2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aDtcclxuICAgIH1cclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1heCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPCB2YWxpZGF0YWJsZUlucHV0Lm1heFxyXG4gICAgfVxyXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA+IHZhbGlkYXRhYmxlSW5wdXQubWluXHJcbiAgICB9XHJcbiAgICByZXR1cm4gaXNWYWxpZDtcclxufVxyXG4iLCJcclxuICAgIC8vIFByb2plY3QgVHlwZVxyXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzICB7QWN0aXZlLCBGaW5zaGVkfVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyxcclxuICAgICAgICAgcHVibGljIHRpdGxlOiBzdHJpbmcsIFxyXG4gICAgICAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZywgXHJcbiAgICAgICAgIHB1YmxpYyBwZW9wbGU6IG51bWJlciwgXHJcbiAgICAgICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXNcclxuICAgICAgICApIHtcclxuXHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvc3RhdHVzXCI7XHJcblxyXG4gICAgLy8gU3RhdGUgTWFuYWdtZW50XHJcbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgU3RhdGU8VD4ge1xyXG4gICAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdO1xyXG4gICAgXHJcbiAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lckZuOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XHJcbiAgICBwcml2YXRlICBwcm9qZWN0czogUHJvamVjdFtdID0gW107XHJcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xyXG5cclxuICAgIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKVxyXG4gICAgfVxyXG5cclxuICAgc3RhdGljIGdldEluc3RhbmNlKCkge1xyXG4gICAgICAgIGlmKHRoaXMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlID0gbmV3IFByb2plY3RTdGF0ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBcclxuXHJcblxyXG4gICAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBudW1PZlBlb3BsZTogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSwgdGl0bGUsIGRlc2NyaXB0aW9uLCBudW1PZlBlb3BsZSwgUHJvamVjdFN0YXR1cy5BY3RpdmUpXHJcblxyXG4gICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIG1vdmVQcm9qZWN0KHByaklkOiBzdHJpbmcsIHByak5ld1N0YXR1czogUHJvamVjdFN0YXR1cykge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQocHJqID0+IHByai5pZCA9PT0gcHJqSWQpO1xyXG4gICAgICAgIGlmKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IHByak5ld1N0YXR1cykge1xyXG4gICAgICAgICAgICBwcm9qZWN0LnN0YXR1cyA9IHByak5ld1N0YXR1cztcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCk7XHJcbmV4cG9ydCB7IFByb2plY3QgfTtcclxuXHJcbiIsImltcG9ydCAgQ29tcG9uZW50ICBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgIEF1dG9iaW5kICBmcm9tIFwiLi4vZGVjb3JhdGVycy9hdXRvYmluZFwiO1xyXG5pbXBvcnQgKiBhcyBWYWxpZGF0aW9uIGZyb20gXCIuLi91dGlsL3ZhbGlkYXRpb25cIjtcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3N0YXRlXCI7XHJcblxyXG5cclxuICAgIC8vIFByb2plY3QgSW5wdXQgY2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PiB7XHJcbiAgICB0aXRsZUlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBkZXNjcmlwdGlvbklucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBwZW9wbGVJbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCdwcm9qZWN0LWlucHV0JywgJ2FwcCcsIHRydWUsICd1c2VyLWlucHV0Jyk7XHJcblxyXG4gICAgICAgIHRoaXMudGl0bGVJbnB1dEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3Blb3BsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcclxuICAgICAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkUGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsLnZhbHVlO1xyXG5cclxuXHJcbiAgICBjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXHJcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgIH1cclxuICAgIFxyXG4gICAgIGNvbnN0IGRlc2NyaXB0aW9uVmFsaWRhdGFibGU6IFZhbGlkYXRpb24uVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcclxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICBtaW5MZW5ndGg6IDVcclxuICAgIH0gIFxyXG5cclxuXHJcbiAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcclxuICAgICAgICB2YWx1ZTogK2VudGVyZWRQZW9wbGUsXHJcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgbWluOiAwLFxyXG4gICAgICAgIG1heDogNVxyXG4gICAgfSAgXHJcblxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUodGl0bGVWYWxpZGF0YWJsZSkgfHxcclxuICAgICAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUoZGVzY3JpcHRpb25WYWxpZGF0YWJsZSkgfHxcclxuICAgICAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUocGVvcGxlVmFsaWRhdGFibGUpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGFsZXJ0KCdJbnZhbGlkIGlucHV0LCBwbGVhc2UgdHJ5IGFnYWluJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gW2VudGVyZWRUaXRsZSwgZW50ZXJlZERlc2NyaXB0aW9uLCArZW50ZXJlZFBlb3BsZV1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsLnZhbHVlID0gJyc7XHJcbiAgICAgICAgdGhpcy5wZW9wbGVJbnB1dEVsLnZhbHVlID0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZTogRXZlbnQpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VySW5wdXQpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZV0gPSB1c2VySW5wdXQ7XHJcbiAgICAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjcmlwdGlvbiwgcGVvcGxlKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICBjb25maWd1cmUoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0SGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpIHt9XHJcblxyXG59XHJcbiIsIlxyXG5pbXBvcnQgIENvbXBvbmVudCAgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IHsgRHJ1Z2dhYmxlIH0gZnJvbSBcIi4uL21vZGVscy9kcnVnZy1kcnVnZ2FibGVcIjtcclxuaW1wb3J0ICBBdXRvYmluZCAgZnJvbSBcIi4uL2RlY29yYXRlcnMvYXV0b2JpbmRcIjtcclxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gJy4uL3N0YXRlL3N0YXRlJztcclxuXHJcbi8vIFByb2plY3RJdGVtIGNsYXNzXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbSBleHRlbmRzIENvbXBvbmVudDxIVE1MVUxpc3RFbGVtZW50LCBIVE1MTElFbGVtZW50PiBpbXBsZW1lbnRzIERydWdnYWJsZXtcclxuICAgIHByaXZhdGUgcHJvamVjdDogUHJvamVjdFxyXG5cclxuICAgIGdldCBwZXJzb25zKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb2plY3QucGVvcGxlID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnMSBwZXJzb24nXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbnNgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XHJcbiAgICAgICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0JywgaG9zdElkLCBmYWxzZSwgcHJvamVjdC5pZCApXHJcbiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDsgXHJcblxyXG4gICAgICAgIFxyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gICAgfVxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpO1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJztcclxuICAgIH1cclxuICAgIEBBdXRvYmluZFxyXG4gICAgZHJhZ0VuZEhhbmRsZXIoXzogRHJhZ0V2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0RyYWdFbmQnKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25maWd1cmUoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcilcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpXHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZCc7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4iLCJcclxuaW1wb3J0ICBBdXRvYmluZCAgZnJvbSBcIi4uL2RlY29yYXRlcnMvYXV0b2JpbmRcIjtcclxuaW1wb3J0IHsgRHJhZ3RhcmdldCB9IGZyb20gXCIuLi9tb2RlbHMvZHJ1Z2ctZHJ1Z2dhYmxlXCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9zdGF0ZS9zdGF0ZSc7XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gXCIuLi9zdGF0ZS9zdGF0ZVwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9zdGF0dXNcIlxyXG5pbXBvcnQgIENvbXBvbmVudCAgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tIFwiLi9wcm9qZWN0LWl0ZW1cIjtcclxuXHJcblxyXG4gICAgLy8gUHJvamVjdExpc3QgY2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBEcmFndGFyZ2V0IHtcclxuICAgIGFzc2lnbmVkUHJvamVjdHMhOiBQcm9qZWN0W107XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKSB7XHJcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtbGlzdCcsICdhcHAnLCBmYWxzZSxgJHt0eXBlfS1wcm9qZWN0c2AgKVxyXG4gICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IFtdXHJcbiAgIFxyXG4gICBcclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gICAgfVxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGlmKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJykge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCBlbEZvcm0gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XHJcbiAgICAgICAgICAgIGVsRm9ybS5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEBBdXRvYmluZFxyXG4gICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KHByaklkLCB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbnNoZWQpXHJcbiAgICB9XHJcbiAgICBAQXV0b2JpbmRcclxuICAgIGRyYWdMZWF2ZUhhbmRsZXIoXzogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgZWxGb3JtID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xyXG4gICAgICAgIGVsRm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpe1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xyXG4gICAgICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZWxldmFudFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKHByaiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLnR5cGUgPT09ICdhY3RpdmUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbnNoZWRcclxuICAgICAgICAgICAgfSApXHJcbiAgICAgICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHJlbGV2YW50UHJvamVjdHM7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvamVjdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgICByZW5kZXJDb250ZW50KCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgJyBQUk9KRUNUUydcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlclByb2plY3QoKSB7XHJcbiAgICAgICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YCkgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgICAgICBsaXN0RWwuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZm9yIChjb25zdCBwcmpFbCBvZiB0aGlzLmFzc2lnbmVkUHJvamVjdHMpIHtcclxuICAgICAgICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCwgcHJqRWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG59XHJcbiIsImltcG9ydCB7IFByb2plY3RJbnB1dCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0TGlzdCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0XCI7XHJcblxyXG5cclxubmV3IFByb2plY3RJbnB1dCgpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwidGVtbHBsYXRlSWQiLCJob3N0RWxJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFbElkIiwidGhpcyIsInRlbXBsYXRlRWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaG9zdEVsIiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEF0QmVnaW5uaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiQXV0b2JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luRGVzY3JpcHRvciIsInZhbHVlIiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsImJpbmQiLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmxlSW5wdXQiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ0b1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW5MZW5ndGgiLCJtYXgiLCJtaW4iLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJTdGF0ZSIsImxpc3RlbmVycyIsImFkZExpc3RlbmVyIiwibGlzdGVuZXJGbiIsInB1c2giLCJQcm9qZWN0U3RhdGUiLCJzdXBlciIsInByb2plY3RzIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsImFkZFByb2plY3QiLCJudW1PZlBlb3BsZSIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXJzIiwibW92ZVByb2plY3QiLCJwcmpJZCIsInByak5ld1N0YXR1cyIsInByb2plY3QiLCJmaW5kIiwicHJqIiwic2xpY2UiLCJwcm9qZWN0U3RhdGUiLCJQcm9qZWN0SW5wdXQiLCJ0aXRsZUlucHV0RWwiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsIiwicGVvcGxlSW5wdXRFbCIsImNvbmZpZ3VyZSIsImdhdGhlclVzZXJJbnB1dCIsImVudGVyZWRUaXRsZSIsImVudGVyZWREZXNjcmlwdGlvbiIsImVudGVyZWRQZW9wbGUiLCJkZXNjcmlwdGlvblZhbGlkYXRhYmxlIiwicGVvcGxlVmFsaWRhdGFibGUiLCJhbGVydCIsImNsZWFySW5wdXRzIiwic3VibWl0SGFuZGxlciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsImNvbnNvbGUiLCJsb2ciLCJhZGRFdmVudExpc3RlbmVyIiwicmVuZGVyQ29udGVudCIsIlByb2plY3RJdGVtIiwicGVyc29ucyIsImhvc3RJZCIsImRyYWdTdGFydEhhbmRsZXIiLCJldmVudCIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiZHJhZ0VuZEhhbmRsZXIiLCJ0ZXh0Q29udGVudCIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsImNsYXNzTGlzdCIsImFkZCIsImRyb3BIYW5kbGVyIiwiZ2V0RGF0YSIsIkZpbnNoZWQiLCJkcmFnTGVhdmVIYW5kbGVyIiwicmVtb3ZlIiwicmVsZXZhbnRQcm9qZWN0cyIsImZpbHRlciIsInJlbmRlclByb2plY3QiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByakVsIl0sInNvdXJjZVJvb3QiOiIifQ==